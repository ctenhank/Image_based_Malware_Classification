# convert filename to *.exe
from pathlib import Path
import hashlib

def attach_ext_exe():
    dataset = Path('./dataset').resolve()
    for path in dataset.rglob('*'):
        if path.is_file():
            path.rename((path.parent / (path.name + '.exe').__str__()))

def count_image_files():
    count = 0
    for path in Path('binary_images/dataset_width_0').rglob('*.png'):
        count += 1
    return count


def __rm_tree(path):
    for child in Path(path).rglob('*'):
        if child.is_dir():
            __rm_tree(child.__str__())
    Path(path).rmdir()

def temp_(path):
    for width_dataset in Path(path).glob('*'):
        for class_ in width_dataset.glob('*'):
            for repo in class_.glob('*'):
                for file in repo.rglob('*.png'):
                    enc = hashlib.md5()
                    with file.open('rb') as f:
                        data = f.read()
                        enc.update(data)
                    file.rename((class_ / (enc.hexdigest() + '.png')).__str__() )
                if repo.is_dir():
                    __rm_tree(repo.__str__())

if __name__ == "__main__":
    temp_('binary_images2')